<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Crear Reporte</title>
    <script>
        function fetchTalleres() {
            var contrato = document.getElementById('contrato').value;
            fetch(`/talleres_por_contrato/${contrato}`)
                .then(response => response.json())
                .then(data => {
                    var talleresSelect = document.getElementById('id_taller');
                    talleresSelect.innerHTML = '';
                    data.forEach(taller => {
                        var option = document.createElement('option');
                        option.value = taller.ID_Talleres;
                        option.text = `Lote: ${taller.Lote}, Item: ${taller.Item}`;
                        talleresSelect.add(option);
                    });
                });
        }
    </script>
</head>
<body>
    <h1>Crear Reporte</h1>
    <form action="/crear_reporte" method="post" enctype="multipart/form-data">
        <label for="contrato">Contrato:</label>
        <select id="contrato" name="contrato" onchange="fetchTalleres()">
            <option value="">Seleccionar Contrato</option>
            {% for proyecto in proyectos %}
            <option value="{{ proyecto.Contrato }}">{{ proyecto.Contrato }}</option>
            {% endfor %}
        </select>
        <br>
        <label for="id_taller">Taller:</label>
        <select id="id_taller" name="id_taller">
            <option value="">Seleccionar Taller</option>
        </select>
        <br>
        <label for="fecha_reporte">Fecha del Reporte:</label>
        <input type="date" id="fecha_reporte" name="fecha_reporte" required>
        <br>
        <label for="descripcion">Descripción:</label>
        <textarea id="descripcion" name="descripcion" required></textarea>
        <br>
        <label for="estatus">Estatus:</label>
        <input type="text" id="estatus" name="estatus" required>
        <br>
        <label for="porciento_eje">Porciento de Ejecución:</label>
        <input type="number" id="porciento_eje" name="porciento_eje" step="0.01" required>
        <br>
        <label for="imagen_1">Imagen 1:</label>
        <input type="file" id="imagen_1" name="imagen_1">
        <br>
        <label for="imagen_2">Imagen 2:</label>
        <input type="file" id="imagen_2" name="imagen_2">
        <br>
        <label for="imagen_3">Imagen 3:</label>
        <input type="file" id="imagen_3" name="imagen_3">
        <br>
        <label for="imagen_4">Imagen 4:</label>
        <input type="file" id="imagen_4" name="imagen_4">
        <br>
        <button type="submit">Crear Reporte</button>
    </form>
</body>
</html>
